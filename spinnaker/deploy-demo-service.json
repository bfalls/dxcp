{
  "application": "dxcp-demo",
  "name": "deploy-demo-service",
  "description": "Deploy demo-service artifact to existing sandbox target",
  "keepWaitingPipelines": false,
  "limitConcurrent": true,
  "parameterConfig": [
    {
      "name": "service",
      "required": true
    },
    {
      "name": "version",
      "required": true
    },
    {
      "name": "artifactRef",
      "required": true
    },
    {
      "name": "engineUrl",
      "required": true
    }
  ],
  "stages": [
    {
      "type": "webhook",
      "name": "deploy-artifact",
      "url": "${ parameters.engineUrl }/deploy",
      "method": "POST",
      "customHeaders": {
        "x-dxcp-engine-token": "encrypted:s3!r:us-east-1!b:dxcp-secrets-406222517046-us-east-1!f:dxcp/secrets.yml!k:controller_token",
        "X-DXCP-Controller-Token": "encrypted:s3!r:us-east-1!b:dxcp-secrets-406222517046-us-east-1!f:dxcp/secrets.yml!k:controller_token"
      },
      "payload": {
        "service": "${ parameters.service }",
        "version": "${ parameters.version }",
        "artifactRef": "${ parameters.artifactRef }"
      }
    }
  ]
}
