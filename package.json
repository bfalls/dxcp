{
  "name": "dxcp",
  "private": true,
  "scripts": {
    "api-dev": "bash -lc 'cd dxcp-api && python3 -m uvicorn main:app --reload --host 0.0.0.0 --port 8000'",
    "api-test": "node scripts/api_test.js",
    "api-test-verbose": "node scripts/api_test.js --verbose",
    "test": "npm run api-test && set PYTHONPATH=dxcp-api && py -m pytest dxcp-api spinnaker-adapter",
    "lint": "ruff check --select F dxcp-api",
    "api-ping": "bash -lc 'curl -sS ${DXCP_API_BASE:-http://127.0.0.1:8000}/v1/health'",
    "api-smoke": "bash -lc 'curl -sS ${DXCP_API_BASE:-http://127.0.0.1:8000}/v1/health && echo'",
    "ec2-instance-id": "aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text",
    "ec2-service-start": "aws ssm get-command-invocation --command-id \"$(aws ssm send-command --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --document-name AWS-RunShellScript --parameters commands='[\"sudo systemctl start spinnaker-compose.service\"]' --query 'Command.CommandId' --output text)\" --instance-id \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --query \"StandardOutputContent\" --output text",
    "ec2-service-stop": "aws ssm get-command-invocation --command-id \"$(aws ssm send-command --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --document-name AWS-RunShellScript --parameters commands='[\"sudo systemctl stop spinnaker-compose.service\"]' --query 'Command.CommandId' --output text)\" --instance-id \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --query \"StandardOutputContent\" --output text",
    "ec2-service-restart": "aws ssm get-command-invocation --command-id \"$(aws ssm send-command --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --document-name AWS-RunShellScript --parameters commands='[\"sudo systemctl restart spinnaker-compose.service\"]' --query 'Command.CommandId' --output text)\" --instance-id \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --query \"StandardOutputContent\" --output text",
    "ec2-service-status": "aws ssm get-command-invocation --command-id \"$(aws ssm send-command --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --document-name AWS-RunShellScript --parameters commands='[\"sudo systemctl status spinnaker-compose.service\"]' --query 'Command.CommandId' --output text)\" --instance-id \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" --query \"StandardOutputContent\" --output text",
    "ec2-start": "aws ec2 start-instances --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' --query 'Reservations[0].Instances[0].InstanceId' --output text)\"",
    "ec2-stop": "aws ec2 stop-instances --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' --query 'Reservations[0].Instances[0].InstanceId' --output text)\"",
    "ec2-status": "aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' --query 'Reservations[0].Instances[0].State.Name' --output text",
    "ec2-restart": "aws ec2 stop-instances --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' --query 'Reservations[0].Instances[0].InstanceId' --output text)\" && aws ec2 start-instances --instance-ids \"$(aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' --query 'Reservations[0].Instances[0].InstanceId' --output text)\"",
    "ec2-public-dns": "aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].PublicDnsName' --output text",
    "ec2-public-ip": "aws ec2 describe-instances --filters 'Name=tag:Name,Values=dxcp-spinnaker' 'Name=instance-state-name,Values=running' --query 'Reservations[0].Instances[0].PublicIpAddress' --output text",
    "ssh-ec2": "scripts/ssh-aws.sh"
  }
}
